var data_sql = {
    "provider": "pg",
    //"login": " `select distinct on (a.id) to_char(b.id) userid,left(to_char(b.id),10) id, b.mabs,b.hoten tenvien,to_char(a.id) idkp, a.ten tenkp from cm_danhmuc.btdkp_bv a inner join cm_data.dloginfull b on left(a.ma,10) = left(to_char(b.id),10)  where b.username_='${username}' and b.password_='${pwd}'`",
    "login_temp": "`select b.id::text userid,left(b.id::text,10) id, b.mabs,b.hoten tenvien,a.id::text idkp, a.ten tenkp, ngaysinh, namsinh, loai_user, a.mabv from ( select a.*,b.mabh from cm_data.dloginfull@meta a left join cm_data.tenvien@meta b on b.id::text = left(a.id::text, 10) where a.username_='${username}' and a.password_='${pwd}') b left join cm_danhmuc.btdkp_bv a on b.mabh = a.mabv`",
    "login_temp2": "`select b.id::text userid,left(b.id::text,10) id,b.mabs,b.hoten tenvien,a.id::text idkp,a.ten tenkp,ngaysinh, namsinh, loai_user from cm_data.dloginfull@meta b inner join cm_danhmuc.btdkp_bv a on b.mabv = a.mabv where b.username_='${username}' and b.password_='${pwd}'`",
    "login": "`select id,mabv,maphai,mabs,mabn,hoten,loai_user from cm_data.dloginfull where username_ = '${username}' and password_ = '${pwd}'  limit 1`",
    "load_khoaphong_old": "` select id,ma,ten,loai from cm_danhmuc.btdkp_bv where mabv='${mabv}' and id in ( select id_kp from cm_danhmuc.cm_khoaphong_bacsi where mabv='${mabv}' and id_bs = '${mabs}' group by id_kp) `",
    "load_khoaphong": "` select id,ma,ten,loai from cm_danhmuc.btdkp_bv where mabv='${mabv}'`",
    "load_khoaphong_input": "` select id,ma,ten,loai from cm_danhmuc.btdkp_bv where mabv='${mabv}' and lower(a.ten) like '%${v}%'`",
    "hiendien": "`select distinct on(a.mabn) b.mabn, mabhyt,b.hoten, a.maql,a.chandoan,a.makp, a.maba,a.mabs,a.mavaovien, a.ngay, b.namsinh,a.loaiba, a.madoituong from (select * from cm_data.benhandt where mabv = '${mabv}') a inner join cm_data.btdbn b on a.mabn = b.mabn and b.mabv = '${mabv}' inner join cm_data.nhapkhoa c on a.maql = c.maql and c.mabv = '${mabv}' where a.mabv = '${mabv}' and a.makp='${idkp}'  and c.id not in (select id from cm_data.xuatkhoa where mabv = '${mabv}' limit 100)` " ,
    "phongkham_chua": "` select distinct on(a.mabn) b.mabn, mabhyt,b.hoten, a.maql, a.makp, a.maba, a.mabs, a.mavaovien, a.ngay, b.namsinh,a.loaiba from cm_data.benhandt a inner join cm_data.btdbn b on a.mabn = b.mabn and b.mabv = '${mabv}' where a.mabv = '${mabv}' and ngay between date'${ngaychon} 00:00:00' and date'${ngaychon} 23:59:59' and a.makp='${idkp}' and loaiba=3 and substring(a.tinhtrang, 9, 1) != '1' `",
    "phongkham_roi": "`  select distinct on(a.mabn) b.mabn, mabhyt,b.hoten, a.maql, a.makp, a.maba, a.mabs, a.mavaovien, a.ngay, b.namsinh,a.loaiba from cm_data.benhandt a inner join cm_data.btdbn b on a.mabn = b.mabn and b.mabv = '${mabv}' where a.mabv = '${mabv}' and ngay between date'${ngaychon} 00:00:00' and date'${ngaychon} 23:59:59' and a.makp='${idkp}' and loaiba=3 and substring(a.tinhtrang, 9, 1) = '1' `",
    "tenBV": "`select ma,ten from cm_danhmuc.tenvien where mabh='${mabv}'`",
    "khoaphong": "`select id,ten,ma from cm_danhmuc.btdkp_bv where mabv = '${mabv}'`",
    "dsBS_old": "`select id,hoten from cm_danhmuc.dmbs where mabv = '${mabv}' and makp='${phongkham}'`",
    "dsBS": "`select id,hoten from cm_danhmuc.dmbs where mabv = '${mabv}'`",
    "namsinh": "`select * from cm_data.btdbn where mabn='${mabn}' and mabv='${mabv}'`",
    "mavv": "`select * from cm_data.benhandt where mabn='${mabn}' and mabv='${mabv}'`",
    "thongtinbn": "`select * from cm_data.btdbn where mabn='${mabn}'`",
    "lichsu": "`select chandoan,ngay from cm_data.benhandt where mabn='${mabn}'`",
    "test": "`select mabn from cm_Data.benhandt LIMIT 5`",
    "tthanhchinh": "`select * from (select * from cm_data.btdbn where mabv='42005') a left join cm_data.lienhe b on a.mabn=b.mabn left join cm_data.quanhe c on b.maql=c.maql where a.mabn = '${mabn}'`",
    "a_xoa_sqlud": "`delete cm_Data.cdkemtheo a where mabv='${mabv}' and id='${id}'`",
    "a_insert_benhkemtheo": "` insert into cm_Data.cdkemtheo(id,maql,maicd,chandoan,ngayud,userid,id_loaicd,mabv) values ('${chuoiid}', '${maql}', '${maicd}', '${chuandoan}', '${ngay}', '${userid}', '0002', '${mabv}') `",
    "login1": "`select username_, password_, count(mabv) from cm_Data.dloginfull where username_='${username}' and password_='${pwd}' group by username_, password_`",
    "test": "`select b.ketqua_hople,a.mabn,i.ma so_ma,i.ten so_ten, f.ma dv_ma, f.ten dv_ten, b.ketqua, b.ghichu, a.sophieu, g.ma nhom_ma, g.ten nhom_ten, h.ma loai_ma, h.ten loai_ten,e.ma ten_ma, e.ten ten_ten, e.csbt_nu, e.csbt_nam, e.ghichu ten_ghichu, to_char(a.ngay,'dd/mm/yyyy hh24:mi') as ngayfrom cm_data.xn_phieu a, cm_data.xn_ketqua b, cm_danhmuc.xn_bv_chitiet c, cm_danhmuc.xn_bv_ten d, cm_danhmuc.xn_ten e,cm_danhmuc.xn_donvi f, cm_danhmuc.xn_nhom g, cm_danhmuc.xn_loai h, cm_danhmuc.xn_so iwhere a.id = b.id and b.id_ten = c.id and d.id = c.id_bv_ten and e.donvi = f.id and c.id_ten = e.id and e.id_nhom = g.id and e.id_loai = h.id and g.id_so = i.id and a.mabn = '${mabn}' --and b.ketqua_hople = 1order by a.ngay desc`",
    "lsngaykham": "`select to_char(ngay,'dd/mm/yy') as ngay from cm_data.xn_phieu where mabn='${mabn}' order by ngay desc`",
    "tenxetnghiem": "`select ma,ten from cm_danhmuc.xn_so order by stt`",
    "ketqua": "`select a.mabn,m.maphai,k.tuoitu,k.tuoiden,k.mincsbt_nam,k.maxcsbt_nam,k.mincsbt_nu,k.maxcsbt_nu,f.ten dv_ten,b.ketqua,h.ma loai_ma,h.ten loai_ten,e.ma ten_ma,e.ten ten_ten,to_char(a.ngay,'dd/mm/yy') as ngay, case	when(m.maphai=1 and b.ketqua::number < k.mincsbt_nu ) then 0    when(m.maphai =1 and b.ketqua::number>k.maxcsbt_nu) then 1    when(m.maphai=1 and (b.ketqua::number>=k.mincsbt_nu and b.ketqua::number <=k.maxcsbt_nu)) then 2   when(m.maphai=0 and b.ketqua::number < k.mincsbt_nam ) then 3    when(m.maphai=0 and b.ketqua::number>k.maxcsbt_nam) then 4    when(m.maphai=0 and (b.ketqua::number>k.mincsbt_nam and b.ketqua::number <k.maxcsbt_nam)) then 5 end kq   from cm_data.xn_phieu a left join cm_data.xn_ketqua b on b.id = a.id left join cm_danhmuc.xn_bv_chitiet c on b.id_ten =c.id_ten left join cm_danhmuc.xn_bv_ten d on d.id=c.id_bv_ten left join cm_danhmuc.xn_ten e on c.id_ten=e.id left join cm_danhmuc.xn_donvi f on e.donvi=f.id left join cm_danhmuc.xn_nhom g on e.id_nhom=g.id left join cm_danhmuc.xn_loai h on e.id_loai=h.id left join cm_danhmuc.xn_so i on g.id_so=i.id left join cm_danhmuc.xn_ten_ct k on e.id = k.id_xn_ten left join cm_data.dloginfull@meta m on m.mabn=a.mabn where '${tuoi}' between k.tuoitu and k.tuoiden and a.mabn='${mabn}' and i.ma='${maxn}' and to_char(a.ngay,'dd/mm/yy')='${ngay}' group by a.mabn,m.maphai,k.tuoitu,k.tuoiden,k.mincsbt_nam,k.maxcsbt_nam,k.mincsbt_nu,k.maxcsbt_nu,f.ten,b.ketqua,h.ma,h.ten,e.ma,e.ten,a.ngay  order by a.ngay desc `",
    "ngaycapthuoc": "`select to_char(ngay,'dd/mm/yy') as ngay from cm_Data.cm_chidinhbd where mabn='${mabn}'`",
    "chitietthuoc_old": "`select b.id, a.mabn,a.mavaovien,a.maql,b.cachdung,c.hamluong,c.duongdung,c.ten,c.dang,d.chandoan,to_char(a.ngay,'dd/mm/yyyy') as ngay from cm_data.cm_chidinhbd a, cm_data.cm_chidinhbdct b, cm_Danhmuc.cm_dmbd c ,cm_data.benhandt d where a.mabn='${mabn}' and b.id=a.id and b.id_bd= c.id and a.maql=d.maql order by ngay desc`",
    "chitietthuoc": "`select a.id, a.mabn,a.mavaovien,a.maql,a.mabs,a.makp,a1.ten as tenkp,case when trim(a2.hoten) != '' then a2.hoten else 'KXD' end as hotenbs, d.chandoan, to_char(a.ngay,'DD-MM-YYYY HH24:MI:SS') as ngay from cm_data.cm_chidinhbd a inner join cm_data.cm_chidinhbdct b on b.id = a.id inner join cm_Danhmuc.cm_dmbd c on b.id_bd = c.id and c.mabv = '${mabv}' inner join cm_data.benhandt d on a.maql = d.maql and d.mabv = '${mabv}' inner join cm_Danhmuc.btdkp_bv a1 on a1.id = a.makp and a1.mabv = '${mabv}' inner join cm_Danhmuc.dmbs a2 on a2.id = a.mabs and a2.mabv = '${mabv}' where a.mabv = '${mabv}' and a.mabn = '${mabn}'  group by a.id, a.mabn, a.mavaovien, a.maql, a.mabs, a.makp, a1.ten, case when trim(a2.hoten) != '' then a2.hoten else 'KXD' end, d.chandoan, to_char(a.ngay, 'DD-MM-YYYY HH24:MI:SS') order by ngay desc`",
    "popupchitiet_old": "`select b.* from  cm_data.cm_chidinhbd a inner join cm_data.cm_chidinhbdct b on b.id = a.id inner join cm_Danhmuc.cm_dmbd c on b.id_bd = c.id and c.mabv = '${mabv}'  inner join cm_data.benhandt d on a.maql = d.maql and d.mabv = '${mabv}' inner join cm_Danhmuc.btdkp_bv a1 on a1.id = a.makp and a1.mabv = '${mabv}' inner join cm_Danhmuc.dmbs a2 on a2.id = a.mabs and a2.mabv = '${mabv}' where a.mabv = '${mabv}' and a.mabn = '${mabn}' and a.id='${idkham}'`",
    "popupchitiet": "`select a.mabn,a.mavaovien,a.maql,b.cachdung,c.hamluong,c.duongdung,c.ten,c.dang,d.chandoan,to_char(a.ngay,'dd/mm/yyyy') as ngay from cm_data.cm_chidinhbd a, cm_data.cm_chidinhbdct b, cm_Danhmuc.cm_dmbd c ,cm_data.benhandt d where a.mabn='${mabn}' and b.id=a.id and b.id_bd= c.id and a.maql=d.maql and a.id='${idkham}' order by ngay desc`",
    "lichsuthuoc_bs": "`select a.mabs, a.maicd, c.id_bd, d.ten, d.generic, c.soluong, c.sodk, c.hamluong, c.maduongdung, c.dvt, c.tyle_tt, c.dongia, c.slngay, c.sllan, c.cachngay, c.songay, c.duongdung, c.thoigian,c.cachdung from (select maql, mabs, maicd, mabv from cm_data.benhandt  where mabv='${mabv}' and mabs = '${mabs}' ) a inner join cm_data.cm_chidinhbd b on b.mabv='${mabv}' and a.maql=b.maql inner join cm_data.cm_chidinhbdct c on c.mabv='${mabv}' and c.id=b.id inner join ((select * from cm_danhmuc.cm_dmbd where mabv='${mabv}')  union all  (select * from cm_danhmuc.cm_dmbd_dk where mabv='${mabv}')) d on d.mabv='${mabv}' and  c.id_bd=d.id  where a.mabv='${mabv}' and b.id = (select b1.id from (select maql, mabs, maicd, mabv from cm_data.benhandt where mabv='${mabv}') a1    inner join cm_data.cm_chidinhbd b1 on b1.mabv='${mabv}' and a1.maql=b1.maql   inner join cm_data.cm_chidinhbdct c1 on c1.mabv='${mabv}' and c1.id=b1.id    where a1.mabv='${mabv}' and a1.mabs='${mabs}' and a1.maicd = '6487'   order by b1.ngay desc limit 1 ) and a.mabs = '101' and a.maicd = '6487'   group by a.mabs, a.maicd, c.id_bd, d.ten, d.generic, c.soluong, c.sodk, c.hamluong, c.maduongdung, c.dvt, c.tyle_tt, c.dongia, c.slngay, c.sllan, c.cachngay, c.songay, c.duongdung, c.thoigian, c.cachdung`",
    "load_cdha": "`select a.id_ct::text id, e.mabs bschidinh, b.ten tenkt, e.mota, e.ketluan, a.ngayud ngay, to_char(a.ngayud,'dd/mm/yy') as m_ngay, e.makt from cm_data.cm_chidinhdv d inner join cm_data.cm_chidinhdvct a on a.id = d.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_dmdv b on a.id_dv = b.id and b.mabv = '${mabv}' inner join cm_meta.cm_dmnhomdv2 c on c.id = b.id_nhomdv2 and c.mabv = '${mabv}' inner join cm_data.cm_cdha_bnll f on f.id_chidinh = d.id inner join cm_data.cm_cdha_bnct e on e.idchidinhct = a.id_ct and e.mabv = '${mabv}' where d.mabv = '${mabv}' and d.mabn = '${mabn}' and c.id in (87, 88, 4018, 59, 4009, 73, 4011, 80, 4007, 75, 5026, 3031, 3244, 4004, 4019, 4020, 62, 56) order by a.ngayud desc`",
    "load_cdha_by_date": "  `select a.id_ct::text id, e.mabs bschidinh, b.ten tenkt, e.mota, e.ketluan, a.ngayud ngay, to_char(a.ngayud,'dd/mm/yy') as m_ngay, e.makt from cm_data.cm_chidinhdv d inner join cm_data.cm_chidinhdvct a on a.id = d.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_dmdv b on a.id_dv = b.id and b.mabv = '${mabv}' inner join cm_meta.cm_dmnhomdv2 c on c.id = b.id_nhomdv2 and c.mabv = '${mabv}' inner join cm_data.cm_cdha_bnll f on f.id_chidinh = d.id inner join cm_data.cm_cdha_bnct e on e.idchidinhct = a.id_ct and e.mabv = '${mabv}' where d.mabv = '${mabv}' and d.mabn = '${mabn}' and c.id in (87, 88, 4018, 59, 4009, 73, 4011, 80, 4007, 75, 5026, 3031, 3244, 4004, 4019, 4020, 62, 56) and to_char(a.ngayud,'yyyy-mm-dd') = '${ngay}' order by a.ngayud desc`  ",
    "load_cdha_by_id": "`select a.id_ct::text id, e.mabs bschidinh, b.ten tenkt, e.mota, e.ketluan, a.ngayud ngay, to_char(a.ngayud,'dd/mm/yy') as m_ngay, e.makt from cm_data.cm_chidinhdv d inner join cm_data.cm_chidinhdvct a on a.id = d.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_dmdv b on a.id_dv = b.id and b.mabv = '${mabv}' inner join cm_meta.cm_dmnhomdv2 c on c.id = b.id_nhomdv2 and c.mabv = '${mabv}' inner join cm_data.cm_cdha_bnll f on f.id_chidinh = d.id inner join cm_data.cm_cdha_bnct e on e.idchidinhct = a.id_ct and e.mabv = '${mabv}' where d.mabv = '${mabv}' and d.mabn = '${mabn}' and c.id in (87, 88, 4018, 59, 4009, 73, 4011, 80, 4007, 75, 5026, 3031, 3244, 4004, 4019, 4020, 62, 56) and a.id='${id}' order by a.ngayud desc`",
    "cdha": "`select to_char(ngay,'dd/mm/yy') as ngay,c.tenkt,a.bsdt,a.ketluan,b.mota,b.makt from cm_data.cdha_bnll a, cm_data.cdha_bnct b,cm_danhmuc.cdha_kythuat c where a.id=b.id and a.mabn='${mabn}' and b.makt=c.makt `",
    "a_load_nhapkhoa": "` select a1.ma, a.id id_nhapkhoa,a.lan, a.maicd,a.chandoan,a.ngay,a.giuong,a.mabs,b.id id_kp, b.ten ten_kp ,c.hoten ten_bs,c.id from cm_data.nhapkhoa a left join cm_data.icd10 a1 on a.maicd=a1.id  left join cm_danhmuc.btdkp_bv b on b.id=a.makp and b.mabv='${mabv}' left join cm_Danhmuc.dmbs c on c.id=a.mabs and c.mabv='${mabv}' where a.mabv='${mabv}' and a.maql='${maql}' `",
    "a_load_tuyentruoc": "` select a.mabv_tuyentruoc,a.maicd,a.chandoan cdtt,b.ten bv_tuyentruoc from cm_data.noigioithieu a inner join cm_danhmuc.cm_dmtuyentruoc b on a.mabv_tuyentruoc=b.id::text where a.mabv='${mabv}' and a.maql='${maql}' `",
    "a_load_chandoankemtheo": "` select a.id::text id,a.maql, maicd,c.ma,c.ten, a.ngayud from cm_Data.cdkemtheo a inner join cm_data.icd10 c on a.maicd =c.id where a.mabv='${mabv}' and a.maql ='${maql}' `",
    "dv_sqld": "`select id_emr, ketqua from cm_data.cm_emr where mabv='${mabv}' and maql ='${maql}' and id_emr = '${id_emr}'`",
    "dv_chuoiis": "`insert into cm_data.cm_emr (id,  mabn, mavaovien, maql, makp, id_emr, ketqua, ngay, ngayud, userid, mabv) values  ('${idbenhan}','${mabn}','${mavaovien}','${maql}','${makp}', '${iddv}', '${noidung}', now(), now(), ${userid}, '${mabv}')`",
    "update_benhchinh": "` update  cm_Data.nhapkhoa set chandoan='${chuandoan_}',maicd='${icd}' where mabn='${mabn}' and mabv='${mabv}'  `",
    "dv_chuoiud": "`update cm_data.cm_emr set ketqua = '${noidung}' where mabv='${mabv}' and maql='${maql}' and id_emr='${iddv}'`",
    "dv_benhsu": "`select hb_benhly from ${medibvMMYY}.bavv_chung where maql='${maql}'`",
    "dv_benhsuis": "` insert into cm_data.cm_emr(id,  mabn, mavaovien, maql, makp, id_emr, ketqua, ngay, ngayud, userid, mabv) values('${idbenhan}', '${mabn}', '${mavaovien}', '${maql}', '${makp}', '${iddv}', '${noidung}',now(), now(), ${userid}, '${mabv}') `",
    "dv_benhsuud": "`update cm_data.cm_emr set ketqua = '${noidung}' where maql='${maql}' and id_emr='${iddv}'`",
    "s_du_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from cm_danhmuc.cm_dmhc where lower(ten) like '%${v}%' limit 150`",
    "s_capnhat_sqlud": " `insert into cm_data.cm_emrdiung (id,mabn,mavaovien,maql,makp,maloaidiung,loaidiung,madiung,diung,mucdodiung,bieuhien,ngay,ngayud,userid, mabv) values ('${chuoiid}','${mabn}','${mavaovien}','${maql}',${makp},${maloaidiung}, '${loaidiung}',${madiung},'${diung}', ${mucdodiung},'${bieuhien}','${ngayphathien}',now(),0, '${mabv}')`",
    "s_getds_sqld": " `select id::text,diung, bieuhien,ngay from cm_data.cm_emrdiung where maql='${maql}' and maloaidiung='${maloaidiung}'`",
    "s_xoa_sqlud": "  `delete from cm_data.cm_emrdiung where id=${id}`",
    "s_ta_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from cm_danhmuc.cm_dmthucpham where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "s_mypham_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from medibv.cm_dmdiungmypham where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "s_khac_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from cm_danhmuc.cm_dmdiungkhac where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "dv_tq_chuoiinsert": "`insert into cm_data.cm_emr (id,  mabn,mavaovien,maql,makp,id_emr,ketqua,ngay,ngayud,userid, mabv) values  ('${idbenhan}','${mabn}','${mavaovien}','${maql}',${makp}, ${iddv},'${noidung}',now(),now(),${localStorage.getItem('userid')}, '${mabv}' ))`",
    "dv_tq_chuoipdate": "`update cm_data.cm_emr set ketqua = '${noidung}' where mabv='${mabv}' and maql='${maql}' and id_emr='${iddv}'`",
    "dv_tq_sqld": "`select id_emr, ketqua from cm_data.cm_emr where mabv='${mabv}' and maql ='${maql}' and id_emr in('3000000075','3000000079','3000000073','3000000077','3000000081') `",
    "o_chuoiinsert": " `insert into cm_data.cm_emr (id, mabn,mavaovien,maql,makp,id_emr,ketqua,ngay,ngayud,userid, mabv)values ('${idbenhan}', '${mabn}', '${mavaovien}', '${maql}', ${makp},${iddv}, '${noidung}', now(), now(), ${localStorage.getItem('userid')}, '${mabv}')`",
    "o_chuoipdate": " `update cm_data.cm_emr set ngayud=now(),ketqua='${noidung}' where mabv='${mabv}' and maql='${maql}' and id_emr='${iddv}'`",
    "o_sqlr": " `select ketqua from cm_data.cm_emr  where maql='${maql}' and id_emr='${iddv}'`",
    "o_load_maba_kp": "`select unnest(regexp_split_to_array(case when maba != '' then maba else '0' end,',')) maba from cm_danhmuc.btdkp_bv where mabv = '${mabv}' and id = '${makp}' `",
    "load_nhom_xn": "` select f.ma manhom,f.ten tennhom from (select * from cm_data.cm_xn_phieu where mabv = '${mabv}') e inner join cm_data.cm_xn_ketqua a on e.id=a.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_bv_chitiet b on a.id_ten =b.id_ten and b.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_bv_ten d on b.id_bv_ten =d.id and d.mabv = '${mabv}' left join cm_danhmuc.cm_xn_bv_so f on d.id_bv_so =f.id and f.mabv = '${mabv}' where e.mabn='${mabn}' group by f.ma,f.ten `",
    "select_xet_nghiem_old": "` select to_char(e.ngay,'yyyy-mm-dd') ngayval,to_char(e.ngay,'dd-mm-yyyy') ngay from (select * from cm_data.cm_xn_phieu where mabv = '${mabv}') e inner join cm_data.cm_xn_ketqua a on e.id=a.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_bv_chitiet b on a.id_ten =b.id_ten and b.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_bv_ten d on b.id_bv_ten =d.id and d.mabv = '${mabv}' left join cm_danhmuc.cm_xn_bv_so f on d.id_bv_so = f.id and f.mabv = '${mabv}' where e.mabv = '${mabv}' and e.mabn='${mabn}' and f.ma='${manhom}' order by e.ngay desc `",
    "select_xet_nghiem": "`select b.mabn,b.maql,b.ngay as ngaynhanmau,d.ten as thongso ,a.ketqua,e.ten as donvi,a.ngayketqua from cm_data.cm_xn_ketqua a inner join cm_data.cm_xn_phieu b on b.id = a.id  and b.mabv='83009' inner join cm_danhmuc.cm_xn_bv_chitiet c on c.id = a.id_ten  and c.mabv='83009' inner join cm_danhmuc.cm_xn_ten d on d.id = c.id_ten  and d.mabv='83009' inner join cm_danhmuc.cm_xn_donvi e on e.id = d.donvi   where b.mabn='17910677' and a.ketqua is not null order by maql `",
    "select_xet_nghiem_ngay": "` select to_char(e.ngay,'yyyy-mm-dd') ngayval,to_char(e.ngay,'dd-mm-yyyy') ngay,c.ten,a.ketqua,d.ten as tenvp from (select * from cm_data.cm_xn_phieu where mabv = '${mabv}') e inner join cm_data.cm_xn_ketqua a on e.id=a.id and a.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_bv_chitiet b on a.id_ten =b.id_ten and b.mabv = '${mabv}' inner join cm_danhmuc.cm_xn_ten c on b.id_ten =c.id and c.mabv = '${mabv}' inner join cm_Danhmuc.cm_xn_bv_ten d on b.id_bv_ten =d.id and d.mabv = '${mabv}' left join cm_Danhmuc.cm_xn_bv_so f on d.id_bv_so = f.id and f.mabv = '${mabv}' where e.mabv = '${mabv}' and e.mabn='${mabn}' and f.ma='${manhom}' and to_char(e.ngay,'yyyy-mm-dd')='${locngay}' order by e.ngay desc `",
    "load_cdha_by_date": "  `select a.id::text,a.bsdt bschidinh,c.tenkt,b.mota,b.ketluan,a.ngay,to_char(a.ngay,'dd/mm/yy') as m_ngay,b.makt from cm_Data.cdha_bnll a, cm_data.cdha_bnct b, cm_danhmuc.cdha_kythuat c where a.id=b.id and b.makt=c.makt and a.mabn='${mabn}' and to_char(a.ngay,'yyyy-mm-dd') = '${ngay}' and  a.id_loai='02' order by a.ngay desc`  ",
    "load_dausinhton_ngay": "`select ngay from cm_data.cm_emrsinhton where mabv='${mabv}' and mabn='${mabn}' order by ngay`",
    "load_dausinhton_old": "`select id::text,ngay,mach,nhietdo,huyetap,cannang,nhiptho from cm_data.cm_emrsinhton where mabv='${mabv}' and mabn='${mabn}' and to_char(ngay,'yyyy-mm-dd') = '${ngay}'`",
    "load_dausinhton": "`select id::text,ngay,mach,nhietdo,huyetap,cannang,nhiptho from cm_data.cm_emrsinhton where mabv='${mabv}' and mabn='${mabn}'`",
    "load_dst_by_id": "`select ngay,mach,nhietdo,huyetap,cannang,nhiptho from cm_data.cm_emrsinhton where mabv='${mabv}' and id='${id}'`",
    "insert_dausinhton": "` insert into cm_data.cm_emrsinhton(id, mavaovien, makp, maql, mabn, mach, nhietdo, huyetap, cannang, nhiptho, ngay, mabv) values( '${id}','${mavv}', '${idkp}', '${maql}',  '${mabn}', ${ mach }, ${ nhietdo }, '${huyetap}', ${ cannang }, ${ nhiptho }, '${ngay}', '${mabv}') `",
    "update_dausinhton": "`update cm_data.cm_emrsinhton set mach=${mach},nhietdo=${nhietdo}, huyetap='${huyetap}', cannang= ${cannang} ,nhiptho=${nhiptho},ngay='${ngay}' where mabv='${mabv}' and id='${id}'`",
    "select_ghinhan_dienbien": "`select a.id, a.ngay, a.ketqua, a.mabs,b.hoten from cm_data.cm_emr a inner join cm_danhmuc.dmbs b on a.mabs != '' and (a.mabs)::number = (b.ma)::number and b.mabv='${mabv}' where a.mabv='${mabv}' and maql = '${maql}' and a.makp = '${makp}'`",
    "select_ghinhan_dienbien_id": "`select a.id, a.ngay, a.ketqua, a.mabs,b.hoten from cm_data.cm_emr  a inner join cm_danhmuc.dmbs b on a.mabs != '' and (a.mabs)::number = (b.ma)::number and b.mabv='${mabv}' where a.mabv='${mabv}' and a.id='${id}'  `",
    "update_ghinhan_dienbien": "`update cm_data.cm_emr set ngay='${ngay}', ngayud=now(),ketqua='${dienbien}' where mabv='${mabv}' and id='${id}'   `",
    "insert_ghinhan_dienbien": "`insert into cm_data.cm_emr(id,mabn,mavaovien, ngay,ketqua,maql,makp,mabs, id_emr, mabv) values( '${id}', '${mabn}', '${mavv}','${ngay}', '${dienbien}', '${maql}', '${makp}','${mabs}','3000000728', '${mabv}')`",
    "show_toathuoc": "` select b.id_ct, trim(c.ten)|| ' ' || c.hamluong as ten, c.dang, b.soluong from cm_data.cm_chidinhbd a inner join cm_data.cm_chidinhbdct b on a.id = b.id and b.mabv='${mabv}' inner join cm_danhmuc.cm_dmbd c on c.id = b.id_bd and c.mabv='${mabv}' inner join cm_meta.cm_dmnhomdv1 d on d.id = c.id_nhomdv1 where a.mabv = '${mabv}' and a.id = '${id}'-- and d.loai_dv1 = 1 `",
    "delete_chidinhbdct": "` delete from cm_data.cm_chidinhbdct where mabv='${mabv}' and id_ct='${id_ct}' `",
    "select_thuoc_all": "` select b.id,to_char(a.ngay,'yyyymmdd') as ngaysort, to_char(a.ngay,'dd/mm/yyyy') as ngay, b.stt, trim(c.ten)|| ' ' || c.hamluong as ten, c.dang, b.soluong, b.cachdung from cm_data.cm_chidinhbd a inner join cm_data.cm_chidinhbdct b on a.id = b.id and b.mabv = '${mabv}' inner join cm_danhmuc.cm_dmbd c on c.id = b.id_bd and c.mabv = '${mabv}' where a.mabv = '${mabv}' and a.mabn = '${mabn}' order by ngaysort desc `",
    "update_chidinhbd": "` update cm_data.cm_chidinhbd set ngay = '${ngay}' where mabv = '${mabv}' and id = '${id}' `",
    "insert_chidinhbd": "`insert into cm_data.cm_chidinhbd (id, mabn, mavaovien, maql, makp, mabs, ngay, tinhtrang, daduyet, idduyet, mabv) values('${id}', '${mabn}', '${mavaovien}', '${maql}', '${makp}', '${mabs}', '${ngay}', '${tinhtrang}', '${daduyet}', '${idduyet}', '${mabv}')`",
    "update_chidinhbdct": "` update cm_data.cm_chidinhbdct set id_bd = '${id_bd}', madoituong = '${madoituong}', soluong = '${soluong}', dongia = '${dongia}',slngay = '${slngay}', sllan = '${sllan}', cachngay = '${cachngay}', songay = '${songay}', duongdung = '${duongdung}', thoigian = '${thoigian}', cachdung = '${cachdung}', kho = '${kho}' where mabv = '${mabv}' and id_ct = '${id_ct}' `",
    "insert_chidinhbdct": "` insert into cm_data.cm_chidinhbdct(id_ct, id, id_bd, stt, madoituong, soluong, dongia, slngay, sllan, cachngay, songay, duongdung, thoigian, cachdung, tinhtrang, kho, nguon, idduyet,maql,tenthuoc,mabn, mabv) values('${id_ct}', '${id}', '${id_bd}', '${stt}', '${madoituong}', '${soluong}', '${dongia}', '${slngay}', '${sllan}', '${cachngay}', '${songay}', '${duongdung}', '${thoigian}', '${cachdung}', '${tinhtrang}', '${kho}', '${nguon}', '${idduyet}','${maql}','${tenthuoc}','${mabn}','${mabv}') `",
    "max_phieu": "` select case when max(phieu) is not null then max(phieu)+1 else 1 end phieu from cm_data.cm_d_duyet where mabv = '${mabv}' and to_char(ngay, 'yyyy-mm-dd') = to_char(now(), 'yyyy-mm-dd')  `",
    "insert_duyet": "` insert into cm_data.cm_d_duyet(id, ngay, loai, phieu, makp, done, mabv)values('${id}', '${ngay}', '${loai}', '${phieu}', '${makp}', '${done}', '${mabv}') `",
    "update_duyet": " ` update cm_data.cm_d_duyet set ngay = '${ngay}' where mabv='${mabv}' and id = '${id}' ` ",
    "load_kho": "`select id, ten from cm_danhmuc.cm_dmkho where mabv= '${mabv}' `",
    "current_chidinh": "` select a.ngay,b.id_ct,trim(c.ten) as ten, b.soluong from cm_data.cm_chidinhdv a inner join cm_data.cm_chidinhdvct b on a.id = b.id inner join cm_danhmuc.cm_dmdv c on c.id = b.id_dv where a.id = '${idchidinhdv}' `",
    "del_chidinhdvct": "` delete from cm_data.cm_chidinhdvct where mabv='${mabv}' and id_ct='${id_ct}' `",
    "update_chidinhdv": "`update cm_data.cm_chidinhdv set ngay = (now() at time zone 'utc' + interval '7 hours') where id = '${id}' `",
    "insert_chidinhdv": "`insert into cm_data.cm_chidinhdv(id, mabn, mavaovien, maql, makp, mabs, ngay, tinhtrang, mabv) values('${id}', '${mabn}', '${mavaovien}', '${maql}', '${makp}', '${mabs}', (now() at time zone 'utc' + interval '7 hours'), '${tinhtrang}', '${mabv}')`",
    "insert_chidinhdvct": "` insert into cm_data.cm_chidinhdvct(id_ct, id, id_dv, stt, madoituong, soluong, dongia, tinhtrang, mabv)values('${id_ct}', '${id}', '${id_dv}', '${stt}', '${madoituong}', '${soluong}', '${dongia}', '${tinhtrang}', '${mabv}') `",
    "load_dt": "` select id, ten from cm_danhmuc.doituong where mabv='${mabv}' order by id `",
    "select_dichvu_all": "` select b.id,to_char(a.ngay,'yyyymmdd') as ngaysort, to_char(a.ngay,'dd/mm/yyyy') as ngay, b.stt, trim(c.ten) as ten, b.soluong from cm_data.cm_chidinhdv a inner join cm_data.cm_chidinhdvct b on a.id = b.id inner join cm_danhmuc.cm_dmdv c on c.id = b.id_dv where mabn = '${mabn}'  order by ngaysort desc `",
    "load_current_dieutri": "` select id::text,ngay,dienbien, ylenh from cm_data.cm_emrdieutri where mabn = '${mabn}' and mabs='${mabs}'  `",

    "ptt_ngay": "` select partition_ngay('${schema}', '${table}', '${key}', 'ngay', '${value}') `",
    "ptt_key": "` select partition_key('${schema}', '${table}', '${mabv}', 'maql', '${value}') `",
    "ptt_mabn": "` select partition_mabn('${schema}', '${table}', '${mabv}', '${mabn}') `",
    "ptt_mabv": "` select partition_mabv('${schema}', '${table}', '${value}') `",
}
var data_sql_orcl = {
    "provider": "orcl",
    "user": "medibvdakhoanghean",
    "update_lydokham": "`update ${user}${mmyy}.lydokham set lydo = '${noidung}' where maql='${maql}'`",
    "insert_lydokham": "`insert into ${user}${mmyy}.lydokham (maql, lydo) values('${maql}', '${noidung}')`",
    "dv_benhsuis": "` insert into ${user}${mmyy}.bavv_chung(maql,hb_benhly, userid) values('${maql}','${noidung}', ${userid}) `",
    "dv_benhsuud": "`update ${user}${mmyy}.bavv_chung set hb_benhly = '${noidung}', userid = ${userid} where maql='${maql}'`",
    "dv_banthanis": "` insert into ${user}${mmyy}.bavv_chung(maql,hb_banthan, userid) values('${maql}','${noidung}', ${userid}) `",
    "dv_banthanud": "`update ${user}${mmyy}.bavv_chung set hb_banthan = '${noidung}', userid = ${userid} where maql='${maql}'`",
    "dv_giadinhis": "` insert into ${user}${mmyy}.bavv_chung(maql,hb_giadinh, userid) values('${maql}','${noidung}', ${userid}) `",
    "dv_giadinhud": "`update ${user}${mmyy}.bavv_chung set hb_giadinh = '${noidung}', userid = ${userid} where maql='${maql}'`",
    "o_ba_update": "`update ${user}${mmyy}.ba_chung set ${field}='${noidung}', mabs='${userid}', userid='${userid}' where idthuchien in (select id from ${user}${mmyy}.ba_thuchien where maql = '${maql}') `",
    "o_thuchien_insert": "` insert into ${user}${mmyy}.ba_thuchien(id, mabn, maql, makp)values('${id_thuchien}', '${mabn}', '${maql}', '${makp}') `",
    "o_bachung_insert": "` insert into ${user}${mmyy}.ba_chung(id, idthuchien, ${field}, mabs, userid)values('${id_bachung}', '${id_thuchien}', '${noidung}', '${userid}', '${userid}') `",
    "s_thoiquen_update_dacdiem": "`update ${user}${mmyy}.ba_hbdacdiem set thoigian='${noidung}' where ma='${ma}' and id in (select id from ${user}${mmyy}.ba_thuchien where maql = '${maql}') `",
    "s_thoiquen_insert_dacdiem": "`insert into ${user}${mmyy}.ba_hbdacdiem(id, ma, thoigian) values((select id from ${user}${mmyy}.ba_thuchien where maql = '${maql}'), '${ma}', '${noidung}') `",
    "s_thuchien_insert": "` insert into ${user}${mmyy}.ba_thuchien(id, mabn, maql, makp)values('${id}', '${mabn}', '${maql}', '${makp}') `",
    "s_dacdiem_insert": "` insert into ${user}${mmyy}.ba_hbdacdiem(id, ma, thoigian)values('${id}', '${ma}', '${noidung}') `",
    "a_cdkemtheo_insert": "` insert into ${user}${mmyy}.cdkemtheo (id, maql, chandoan, maicd, loai, stt)values ('${id}', '${maql}','${chuandoan}', '${maicd}','4','1') `",
    "p_dausinhton_insert": "`insert into ${user}.d_dausinhton(id, idkhoa, ngay, mabs , mach, nhietdo, huyetap, cannang, nhiptho) values( '${id}', '${idkp}', '${ngay2}', '${mabs}', '${mach}', '${nhietdo}', '${huyetap}', '${cannang}', '${nhiptho}' ) `",
    "p_dausinhton_insert_test": "`insert into ${user}.d_dausinhton(id,idkhoa) values( '${id}', '${idkp}' ) `",
    "p_dausinhton_update": "`update ${user}.d_dausinhton set mach= ${mach}, nhietdo= ${nhietdo}, huyetap= '${huyetap}', cannang= ${cannang}, nhiptho = ${nhiptho}, ngay='${ngay2}' where id='${id}'`",
    "p_select_idthuchien": "`select to_char(id) id from ${user}${mmyy}.ba_thuchien where maql = '${maql}'`",
    "p_update_dieutri": "`update ${user}${mmyy}.ba_dieutri set ngay='${ngay2}', mabs='${mabs}', dienbien = '${dienbien}' where idthuchien in (select id from ${user}${mmyy}.ba_thuchien where maql = '${maql}') `",
    "p_insert_dieutri_1": "`insert into ${user}${mmyy}.ba_dieutri(id, idthuchien, ngay, mabs, dienbien) values('${id}','${idthuchien_get}', '${ngay2}', '${mabs}', '${dienbien}') `",
    "p_thuchien_insert": "` insert into ${user}${mmyy}.ba_thuchien(id, mabn, maql, makp)values('${idthuchien}', '${mabn}', '${maql}', '${makp}') `",
    "p_insert_dieutri_2": "` insert into ${user}${mmyy}.ba_dieutri(id, idthuchien, ngay, mabs, dienbien)values('${id}', '${idthuchien}', '${ngay2}', '${mabs}', '${dienbien}') `",
    "p_insert_chidinhdv": "` insert into ${user}${mmyy}.v_chidinh(id, loai, mavp, mabn, maql, ngay, makp, madoituong, soluong, dongia, userid, tinhtrang, mabs, chandoan, idchidinh, bhyt, mavaovien, maicd)values ('${id}', 1, '${mavp}', '${mabn}', '${maql}', '${ngay}', '${ngay1}', '${makp}', '${madoituong}', ${soluong}, ${dongia}, '${userid}', 1, '${mabs}', '${chandoan}', '${idchidinh}','${bhyt}', '${mavaovien}', '${maicd}') `",


    "login": "`select Id, HOTEN,USERID,MAKP,MABS from medibv.dlogin where USERID ='${username}' and password_='${pwd}'`",
    "login_dl": "`select count(mabs) ok from medibv1118.v_chidinh where mabs = '${username}' and password_ = '${pwd}' limit 1`",
    "load_hoten_dl": "`select hoten from medibv.dmbs where ma='${mabs}'`",
    "load_kp_dl": "`select * from medibv.khoaphong_bacsi where mabs='${mabs}'`",
    "load_info_bs_dl": "`select a.hoten, b.mabs, b.makp from medibv.dmbs a inner join medibv.khoaphong_bacsi b on a.ma = b.mabs where mabs='${mabs}' order by b.makp asc `",
    "khoaphong": "`select makp,tenkp, loai from medibv.btdkp_bv where makp in (${map})`",
    "load_cdha": "`select a.id::text,a.bschidinh,c.tenkt,b.mota,b.ketluan,a.ngay,to_char(a.ngay,'dd/mm/yy') as m_ngay,b.makt from ${medibvMMYY}.cdha_bnll a, ${medibvMMYY}.cdha_bnct b, medibv.cdha_kythuat c where a.id=b.id and b.makt=c.makt and a.mabn='${mabn}' and  a.id_loai='02' order by a.ngay desc`",
    "load_cdha_by_date": "  `select a.id::text,a.bschidinh,c.tenkt,b.mota,b.ketluan,a.ngay,to_char(a.ngay,'dd/mm/yy') as m_ngay,b.makt from ${medibvMMYY}.cdha_bnll a, ${medibvMMYY}.cdha_bnct b, medibv.cdha_kythuat c where a.id=b.id and b.makt=c.makt and a.mabn='${mabn}' and to_char(a.ngay,'yyyy-mm-dd') = '${ngay}' and  a.id_loai='02' order by a.ngay desc`  ",
    "load_cdha_by_id": "`select a.id::text,a.bschidinh,c.tenkt,b.mota,b.ketluan,a.ngay,to_char(a.ngay,'dd/mm/yy') as m_ngay,b.makt from ${medibvMMYY}.cdha_bnll a, ${medibvMMYY}.cdha_bnct b, medibv.cdha_kythuat c where a.id=b.id and b.makt=c.makt and a.mabn='${mabn}' and a.id=${id} order by a.ngay desc`",
    "hiendien": "`select a.mabn mabn, to_char(a.maql) maql,a.ngay ngay,to_char(a.mavaovien) mavaovien, b.hoten hoten, b.namsinh namsinh,c.sothe mabhyt,a.makp makp,d.madoituong madoituong,d.loaiba loaiba from medibv.hiendien a inner join medibv.btdbn b on a.mabn = b.mabn inner JOIN medibv.benhandt d on a.mabn = d.mabn and a.maql = d.maql LEFT OUTER  join medibv.bhyt c on a.maql = c.maql where a.nhapkhoa =1 and a.xuatkhoa =0 and a.ngay <= '${ngay}' and a.makp = '${idkp}'`",
    "phongkham_chua": "`select a.mabn, d.maql::text maql, a.ngay, a.mavaovien::text mavaovien,b.hoten hoten, b.namsinh namsinh,c.sothe mabhyt,a.makp makp, a.madoituong, 3 loaiba from medibv.tiepdon a inner join ${medibvMMYY}.benhanpk d on a.mavaovien=d.mavaovien inner join medibv.btdbn b on a.mabn = b.mabn  LEFT OUTER join medibv.bhyt c on a.maql = c.maql where a.makp='${idkp}' and a.ngay <= '${ngay}' and a.maql not in (select maql from medibv.benhanpk_ketthuc where makp='${idkp}')  order by a.ngay desc`",
    "phongkham_roi": "`select a.mabn, a.maql::text maql, a.ngay, a.mavaovien::text mavaovien,b.hoten hoten, b.namsinh namsinh,c.sothe mabhyt,a.makp makp, a.madoituong, 3 loaiba from medibv.tiepdon a inner join medibv.btdbn b on a.mabn = b.mabn  LEFT OUTER join medibv.bhyt c on a.maql = c.maql where a.makp='${idkp}' and a.ngay <= '${ngay}' and a.maql in (select maql from medibv.benhanpk_ketthuc where makp='${idkp}')  order by a.ngay desc`",
    "dv_chuoiis": "`insert into medibv1118.lydokham (maql, lydo) values('${maql}','${noidung}')`",
    "dv_chuoiud": "`update medibv1118.lydokham set lydo = '${noidung}' where maql='${maql}'`",
    "dv_sqlr": "`select lydo ketqua from ${medibvMMYY}.lydokham where maql='${maql}'`",
    "dv_benhsu": "`select hb_benhly from ${medibvMMYY}.bavv_chung where maql='${maql}'`",

    "dv_banthan": "`select hb_banthan from ${medibvMMYY}.bavv_chung where maql='${maql}'`",

    "dv_giadinh": "`select hb_giadinh from  ${medibvMMYY}.bavv_chung where maql='${maql}'`",

    "dv_sqld": "`select id_emr, ketqua from cm_data.cm_emr where maql ='${maql}' and id_emr in ('3000000072','3000000076','3000000080','3000000074','3000000078','3000000082')`",
    "dv_tq_chuoiinsert": "`insert into medibv.cm_emr (id,mabn,mavaovien,maql,makp,id_emr,ketqua,ngay,ngayud,userid) values ('${idbenhan}','${mabn}','${mavaovien}','${maql}',${makp},${iddv},'${noidung}',now(),now(),0)`",
    "dv_tq_chuoipdate": "`update medibv.cm_emr set ngayud=now(),ketqua='${noidung}' where maql='${maql}' and id_emr=${iddv}`",
    "dv_tq_sqld": "`select id_emr, ketqua from medibv.cm_emr where maql ='${maql}' and id_emr in  ('3000000072','3000000076','3000000080','3000000074','3000000078','3000000082')`",
    "o_chuoiinsert": " `insert into medibv.cm_emr (id, mabn,mavaovien,maql,makp,id_emr,ketqua,ngay,ngayud,userid) values ('${idbenhan}','${mabn}','${mavaovien}','${maql}',${makp},${iddv},'${noidung}',now(),now(),0)`",
    "o_chuoipdate": " `update medibv.cm_emr set ngayud=now(),ketqua='${noidung}' where maql='${maql}' and id_emr=${iddv}`",
    "o_sqlr": " `select ketqua from medibv.cm_emr  where maql='${maql}' and id_emr=${iddv}`",
    "o_checkexists": " `select 1 from medibv.cm_emr where maql='${maql}' and id_emr=${iddv}`",
    "o_load_maba_kp": "`select case when maba != '' then unnest(regexp_split_to_array(maba,','))::number else 0 end maba from medibv.btdkp_bv where makp = '${makp}'`",
    "o_load_idemr": "`select id_emr from medibv.cm_emr where maql='${maql}'`",
    "s_xoa_sqlud": "  `delete from medibv.cm_emrdiung where id=${id}`",
    "s_getds_sqld": " `select id,diung, bieuhien,phathienngay from medibv.cm_emrdiung where maql='${maql}' and maloaidiung=${maloaidiung}`",
    "load_schema_temp": "`select schema_name from information_schema.schemata where schema_name = '${schema}'`",
    "select_thuoc_noitru": "`select to_char(aa.ngay,'yyyymmdd')as ngaysort, p.loai loai, aa.phieu, p.ten as tenphieu ,to_char(aa.ngay,'dd/mm/yyyy')as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.slyeucau as soluong,b.cachdung from medibv1118.d_duyet aa, medibv1118.d_dutrull a, medibv1118.d_dutruct b, medibv.d_dmbd c, medibv.d_loaiphieu p where aa.id = a.idduyet and a.id = b.id and b.mabd = c.id and aa.phieu = p.id and mabn = '${mabn}' and maql = '${maql}' union all select to_char(aa.ngay, 'yyyymmdd') as ngaysort, p.loai, aa.phieu, p.ten as tenphieu, to_char(aa.ngay,'dd/mm/yyyy') as ngay, b.stt, trim(c.ten)|| ' ' || c.hamluong as ten, c.dang, b.slyeucau as soluong, b.cachdung from medibv1118.d_duyet aa, medibv1118.d_xtutrucll a, medibv1118.d_xtutrucct b, medibv.d_dmbd c, medibv.d_loaiphieu p where aa.id = a.idduyet and a.id = b.id and b.mabd = c.id and aa.phieu = p.id and mabn = '${mabn}' and maql = '${maql}'` ",
    "select_thuoc_noitru_temp": "`select to_char(aa.ngay,'yyyymmdd')as ngaysort, p.loai loai, aa.phieu, p.ten as tenphieu ,to_char(aa.ngay,'dd/mm/yyyy')as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.slyeucau as soluong,b.cachdung, c.duongdung from ${medibvMMYY}.d_duyet aa, ${medibvMMYY}.d_dutrull a, ${medibvMMYY}.d_dutruct b, medibv.d_dmbd c, medibv.d_loaiphieu p,medibv.d_dmnhom d where aa.id = a.idduyet and a.id = b.id and b.mabd = c.id and aa.phieu = p.id and d.id= c.manhom and d.nhomvp = 7 and mabn = '${mabn}' and maql = '${maql}' union all select to_char(aa.ngay, 'yyyymmdd') as ngaysort, p.loai, aa.phieu, p.ten as tenphieu, to_char(aa.ngay,'dd/mm/yyyy') as ngay, b.stt, trim(c.ten)|| ' ' || c.hamluong as ten, c.dang, b.slyeucau as soluong, b.cachdung, c.duongdung from ${medibvMMYY}.d_duyet aa, ${medibvMMYY}.d_xtutrucll a, ${medibvMMYY}.d_xtutrucct b, medibv.d_dmbd c, medibv.d_loaiphieu p where aa.id = a.idduyet and a.id = b.id and b.mabd = c.id and aa.phieu = p.id and mabn = '${mabn}' and maql = '${maql}'` ",
    "select_thuoc_all": "` (select to_char(a.ngay,'yyyymmdd') as ngaysort, null loai, null as phieu, null as tenphieu, to_char(a.ngay,'dd/mm/yyyy') as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.slyeucau as soluong,b.cachdung from ${medibvMMYY}.d_thuocbhytll a,${medibvMMYY}.d_thuocbhytct b,medibv.d_dmbd c,medibv.d_dmnhom d where a.id=b.id and b.mabd=c.id and d.id= c.manhom and d.nhomvp = 7 and mabn = '${mabn}' ) union all (select to_char(a.ngay,'yyyymmdd')as ngaysort, null loai, null as  phieu, null as tenphieu ,to_char(a.ngay,'dd/mm/yyyy')as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.soluong as soluong,b.cachdung from ${medibvMMYY}.d_toathuocll a,${medibvMMYY}.d_toathuocct b,medibv.d_dmbd c,medibv.d_dmnhom d where a.id=b.id and b.mabd=c.id and d.id= c.manhom and d.nhomvp = 7 and mabn = '${mabn}'  ) union all (select to_char(aa.ngay,'yyyymmdd')as ngaysort, p.loai::text, aa.phieu::text, p.ten as tenphieu ,to_char(aa.ngay,'dd/mm/yyyy')as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.slyeucau as soluong,b.cachdung from ${medibvMMYY}.d_duyet aa ,${medibvMMYY}.d_dutrull a,${medibvMMYY}.d_dutruct b,medibv.d_dmbd c, medibv.d_loaiphieu p,medibv.d_dmnhom d where aa.id=a.idduyet and a.id=b.id and b.mabd=c.id and aa.phieu =p.id and d.id= c.manhom and d.nhomvp = 7 and mabn = '${mabn}' )union all ( select to_char(aa.ngay,'yyyymmdd')as ngaysort,p.loai::text, aa.phieu::text, p.ten as tenphieu ,to_char(aa.ngay,'dd/mm/yyyy') as ngay, b.stt,trim(c.ten)||' '||c.hamluong as ten,c.dang,b.slyeucau as soluong,b.cachdung from ${medibvMMYY}.d_duyet aa, ${medibvMMYY}.d_xtutrucll a,${medibvMMYY}.d_xtutrucct b,medibv.d_dmbd c, medibv.d_loaiphieu p,medibv.d_dmnhom d where aa.id=a.idduyet and a.id=b.id and b.mabd=c.id and aa.phieu =p.id and d.id= c.manhom and d.nhomvp = 7 and mabn = '${mabn}' ) `",
    "select_chidinh": "`select b.ten,a.ngay, a.soluong, a.dongia from ${medibvMMYY}.v_chidinh a inner join medibv.v_giavp b on a.mavp = b.id where mabn = '${mabn}' and maql = '${maql}'`",
    "test_schema": "`select * from ${medibvMMYY}`",
    "load_schema": "`select schema_name, right(schema_name,2)||left(right(schema_name,4),2) as yymm from information_schema.schemata where schema_name like 'medibv_%' and right(schema_name, 2) || left(right(schema_name, 4), 2) between to_char(date'${date}' - '1 month':: interval, 'yymm') and to_char(date'${date}' + '1 month':: interval, 'yymm') order by yymm desc`",
    "s_capnhat_sqlud": " `insert into medibv.cm_emrdiung (id,mabn,mavaovien,maql,makp,maloaidiung,loaidiung,madiung,diung,mucdodiung,bieuhien,phathienngay,ngayud,userid) values ('${chuoiid}','${mabn}','${mavaovien}','${maql}',${makp},${maloaidiung}, '${loaidiung}',${madiung},'${diung}', ${mucdodiung},'${bieuhien}','${ngayphathien}',now(),0)`",
    "s_du_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from medibv.d_dmhoatchat where lower(ten) like '%${v}%' limit 150`",
    "s_khac_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from medibv.cm_dmdiungkhac where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "s_ta_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from medibv.cm_dmthucpham where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "s_mypham_get_thuoc_sqld": " `select distinct on(ten) id ma,ten from medibv.cm_dmdiungmypham where lower(ten) like '%${v.toLowerCase()}%' limit 150`",
    "a_getct_benhchinh_maql": "`                select a.id, a.ngay,b.maql,to_char(b.maicd)  maicd,c.ma,c.ten from cm_data.xuatkhoa a                 inner join cm_data.nhapkhoa b on a.id = b.id                 inner join cm_danhmuc.icd10 c on a.maicd =c.id                 where b.maql ='${maql}'`",
    "a_getct_lienquan_sqld": " ` select a.id,a.maql,to_char(maicd) maicd,c.ma,c.ten, a.ngayud from cm_data.cdkemtheo a              inner join cm_danhmuc.icd10 c on a.maicd =c.id             where a.maql ='${maql}'`",
    "load_dausinhton": "`select id::text,ngay,mach,nhietdo,huyetap,cannang,nhiptho from medibv.ba_dausinhton where mabn='${mabn}' and to_char(ngay,'yyyy-mm-dd') = '${ngay}'`",
    "load_dausinhton_ngay": "`select ngay from medibv.ba_dausinhton where mabn='${mabn}' order by ngay`",
    "load_nhom_xn": "` select distinct(f.ma) manhom,f.ten tennhom from  medibv1018.xn_phieu e inner join medibv1018.xn_ketqua a on e.id=a.id inner join medibv.xn_bv_chitiet b on a.id_ten =b.id inner join medibv.xn_bv_ten d on b.id_bv_ten =d.id left join medibv.xn_bv_so f on d.id_bv_so =f.id where e.mabn='${mabn}' group by f.ma,f.ten `",
    "select_xet_nghiem": "` select to_char(e.ngay,'yyyy-mm-dd') ngayval,to_char(e.ngay,'dd-mm-yyyy') ngay from  medibv1018.xn_phieu e inner join medibv1018.xn_ketqua a on e.id=a.id inner join medibv.xn_bv_chitiet b on a.id_ten =b.id inner join medibv.xn_ten c on b.id_ten =c.id inner join medibv.xn_bv_ten d on b.id_bv_ten =d.id left join medibv.xn_bv_so f on d.id_bv_so = f.id where e.mabn='${mabn}' and f.ma='${manhom}' order by e.ngay desc `",
    "select_xet_nghiem_ngay": "` select to_char(e.ngay,'yyyy-mm-dd') ngayval,to_char(e.ngay,'dd-mm-yyyy') ngay,c.ten,a.ketqua,d.ten as tenvp from  medibv1018.xn_phieu e inner join medibv1018.xn_ketqua a on e.id=a.id inner join medibv.xn_bv_chitiet b on a.id_ten =b.id inner join medibv.xn_ten c on b.id_ten =c.id inner join medibv.xn_bv_ten d on b.id_bv_ten =d.id left join medibv.xn_bv_so f on d.id_bv_so = f.id where e.mabn='${mabn}' and f.ma='${manhom}' and to_char(e.ngay,'yyyy-mm-dd')='${locngay}' order by e.ngay desc `",
    "insert_dausinhton": "`insert into medibv.ba_dausinhton(id,idkhoa,maql,mabs,mabn, mach, nhietdo, huyetap, cannang, nhiptho, ngay) values((select case when max(id) is null then 1 else max(id)+1 end id from medibv.ba_dausinhton),(select max(id) from medibv.nhapkhoa where mabn='${mabn}' group by maql order by max(id) desc limit 1 ),(select maql from medibv.nhapkhoa where mabn='${mabn}' group by maql order by max(id) desc limit 1 ),'${mabs}','${mabn}',${mach},${nhietdo},'${huyetap}',${cannang},${nhiptho},'${ngay}')`",
    "update_dausinhton": "`update medibv.ba_dausinhton set mach=${mach},nhietdo=${nhietdo},huyetap='${huyetap}',cannang= ${cannang} ,nhiptho=${nhiptho},ngay='${ngay}' where id='${id}'`",
    "select_ghinhan_dienbien": "`select a.id, a.ngay, a.dienbien, a.mabs,b.hoten from medibv.ba_dieutri  a inner join medibv.dmbs b on a.mabs = b.ma where maql = '${maql}' and idkhoa = '${makp}'`",
    "select_ghinhan_dienbien_id": "`select a.id, a.ngay, a.dienbien, a.mabs,b.hoten from medibv.ba_dieutri  a inner join medibv.dmbs b on a.mabs = b.ma where id=${id}  `",
    "insert_ghinhan_dienbien": "`insert into medibv.ba_dieutri(id, ngay,dienbien,maql,idkhoa,mabs) values( (select case when max(id) is null then 1 else max(id) + 1 end id from medibv.ba_dieutri) ,'${ngay}', '${dienbien}', '${maql}' , '${makp}','${mabs}')`",
    "update_ghinhan_dienbien": "`update medibv.ba_dieutri set ngay='${ngay}',dienbien='${dienbien}' where id=${id}   `",
    "load_dst_by_id": "`select ngay,mach,nhietdo,huyetap,cannang,nhiptho from medibv.ba_dausinhton where id='${id}'`",
    "a_xoa_sqlud": "`delete from medibv.cdkemtheo where id=${id}`",
    "loadnhomxn": "select ma,ten from medibv.xn_bv_so",
    "loadnhomxn1": " `select a.ma ma_ct,a.ten ten_ct,b.ma ma_gr, b.ten ten_gr from medibv.xn_bv_ten a inner join medibv.xn_bv_so b on a.id_bv_so = b.id where b.ma = '${ma_gr}'` ",
    "a_get_icd10_sqld": " `select to_char(id) id, ma,ten from cm_danhmuc.icd10 where lower(ma)='${v}'`",
    "a_capnhatbenhkemtheo_sqlud": "`insert into cm_data.cdkemtheo(id,maql,maicd,chandoan,ngayud,userid) values                                               ('${chuoiid}','${maql}',${maicd},'${chuandoan}','${ngay}',${localStorage.getItem('userid')})`",
    "a_capnhatbenhchinh_sqltimid": "`select id from cm_data.nhapkhoa where maql ='${maql}'`",
    "a_capnhatbenhchinh_sqlud": "`update cm_data.xuatkhoa set maicd =${maicd},chandoan='${chuandoan}',ngay='${ngay}' where id='${idnhapkhoa}'`",
    "a_capnhatbenhchinh_sqludi": "`Insert into cm_data.xuatkhoa (id,maicd,ngay,chandoan)                            select b.id,${maicd} maicd, '${ngay}' ngay, '${chuandoan}' chuandoan from cm_data.nhapkhoa b where b.maql ='${maql}'                                   `",
}